import{EventTarget as t,Node as e,EndpointSegment as n,EndpointFixedName as s,Point as i,CircleNode as r,Cursor as o,Position as a,PositionInvertMap as l,DefaultZIndexs as c,Link as h,AutoFoldLink as u,isHorizontal as d,CurveLink as p,BezierLink as f,Style as g,getNearestPointOnObjectsOBB as y,getNearestAnchorOnObjects as I,DisplayObject as m,LinkHelper as b,Rectangle as w,ResourceLoader as x,EventNames as C,StageMode as S,NodeHelper as v,Shape as k,getClass as L,PopupMenu as H,InputTextfield as P,Tooltip as E,setProto as T,topo as D}from"@topo/core";const j=O;!function(t,e){const n=O,s=z();for(;;)try{if(186705===-parseInt(n(296))/1*(-parseInt(n(279))/2)+-parseInt(n(294))/3+parseInt(n(278))/4+parseInt(n(292))/5+parseInt(n(293))/6*(-parseInt(n(298))/7)+-parseInt(n(280))/8+-parseInt(n(276))/9)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();class M extends t{constructor(t){const e=O;super(),this[e(295)]=t,this[e(287)],this[e(286)](),this.hide()}[j(286)](){const t=j;let e=document[t(288)](t(275));return e[t(285)][t(302)](t(277)),this[t(295)][t(299)][t(290)](e),this[t(287)]=e,this}[j(306)](){const t=j;return this[t(287)][t(289)][t(303)]=t(282),this}show(){const t=j;return this[t(287)][t(289)][t(303)]=t(281),this}getDragItem(){return this[j(297)]}setConfig(t){const e=j;let n=this;return t.items[e(300)]((function(t){const s=e;let i=document[s(288)](s(275));i.classList[s(302)](s(283)),i[s(301)]=t[s(284)],i[s(291)](s(304),!0),i[s(305)]=function(e){n.dargItem=t},n[s(287)][s(290)](i)})),this}}function O(t,e){const n=z();return(O=function(t,e){return n[t-=275]})(t,e)}function z(){const t=["block","none","item","iconHtml","classList","initDom","domElement","createElement","style","appendChild","setAttribute","885775yiVRfg","9654BJktFW","140850sUnmJz","stage","2tkBGyr","dargItem","196dVdGZn","layersContainer","forEach","innerHTML","add","display","draggable","ondragstart","hide","div","1358316sbNyiZ","topo_iconsPanel","881668VRRBSw","337674SoXROK","2444920aFMMnX"];return(z=function(){return t})()}const N=B;function A(){const t=["fontFamily","appendChild","add","getCtroller","textAlign","selectedGroup","square","setFolderValues","setValue","onFinishChange","GUI","property","onChange","center","text","isNode","__controllers","position","整体透明度","borderWidth","right","height","block","open","1196855dOEbzP","-15px","domElement","图片路径","fontWeight","backgroundColor","removeAll","forEach","keys","355296dhlxgd","className","style","3,3","editor","imageSrc","css","getValue","isLink","lineCap","addFolder","1,10","gray","1733778jFeOOx","show","display","showProperty","边框粗细","12px","layersContainer","init","arial","newFolder","gui","基础属性","folders","inputSystem","184550xXcGzx","getCtrollerValue","sans-serif","0px","2,2","lineWidth","color","nodeCtrlBox","3,7","840923pyZisy","线条粗细","round","serif","top","线条颜色","dat","3187316iMjRWD","strokeStyle","none","width","fontSize","globalAlpha","string","absolute","close","basic","styleSystem","节点属性","__folders","attachTo","zIndex","butt","stage","split","填充颜色","9963688zTbXOt","object","update","lineDash","getStyle","name","hide","连线属性","getFolder"];return(A=function(){return t})()}function B(t,e){const n=A();return(B=function(t,e){return n[t-=289]})(t,e)}!function(t,e){const n=B,s=A();for(;;)try{if(912987===parseInt(n(372))/1+parseInt(n(363))/2+-parseInt(n(336))/3+-parseInt(n(379))/4+-parseInt(n(327))/5+-parseInt(n(349))/6+parseInt(n(294))/7)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();class G{constructor(t,e){const n=B;this[n(340)]=t,this[n(378)]=e,this[n(359)]=new(e[n(313)]),this[n(295)],this[n(361)]={}}setCurrentObject(t){const e=B,n=this.editor,s=this[e(340)].stage;s[e(362)].target=t,s[e(308)][e(333)]()[e(305)](t),t[e(344)]?n.linkCtrlBox[e(392)](t):t[e(318)]&&n[e(370)][e(392)](t),n[e(296)](),this[e(352)](t)}[N(352)](t){const e=N;if(null==t)return;this[e(388)]={id:t.id,name:"",x:1,y:1,imageSrc:"",width:1,height:1,text:"",rotation:0};const n=this[e(340)][e(291)][e(389)].currentTheme[e(298)](t[e(337)]);this[e(338)]={lineDash:null,backgroundColor:"",textAlign:n[e(307)]||e(316),textBaseline:n[e(307)]||"middle",strokeStyle:n.strokeStyle||e(348),fillStyle:"",color:n[e(369)]||"",borderWidth:0,fontSize:e(354),fontFamily:e(357),lineWidth:n[e(368)]||0,lineCap:e(290),globalAlpha:1};const s=this.basic,i=this[e(338)];Object[e(335)](s)[e(334)]((function(e){null!=t[e]&&(s[e]=t[e])})),Object[e(335)](i)[e(334)]((function(n){const s=e;let r=t.style[n];null!=t[s(338)][n]&&(i[n]=r)})),null==this.object&&(this[e(295)]=t,this[e(356)]()),this[e(295)]=t,i[e(322)]=t[e(338)][e(322)]||0,i[e(331)]=t[e(338)][e(331)],i[e(383)]=t[e(338)][e(383)],i[e(303)]=t[e(338)][e(303)],this[e(310)](s,i),t[e(318)]&&null!=this[e(302)](e(390))?(this[e(302)]("节点属性")[e(350)](),this[e(302)](e(301))[e(300)]()):null!=this[e(302)]("连线属性")&&(this[e(302)]("连线属性")[e(350)](),this[e(302)](e(390))[e(300)]())}[N(358)](t){const e=N,n=this[e(359)][e(346)](t);return this.folders[t]=n,n}[N(302)](t){return this[N(361)][t]}[N(364)](t,e){const n=N;return this[n(306)](t,e)[n(343)]()}[N(306)](t,e){const n=N;return this[n(302)](t)[n(319)].find((t=>t[n(314)]===e))}setFolderValues(t,e){const n=N;Object[n(335)](this[n(359)][n(391)])[n(334)]((s=>{const i=n;this.gui[i(391)][s][i(319)][i(334)]((function(n){const s=i;let r=n.property;null!=t[r]?n[s(311)](t[r]):null!=e[r]&&n.setValue(e[r])}))}))}init(){const t=N,e=this,n=this[t(340)],s=n[t(291)],i=this[t(388)],r=this.style;let o={"实线":"","虚线1,1":"1,1","虚线2,2":t(367),"虚线3,3":t(339),"虚线7,3":"7,3","虚线3,7":t(371),"虚线10,1":"10,1","虚线1,10":t(347)},a=["Arial",t(375),t(365)],l={"默认":"butt","圆形":t(374),"矩形":t(309)};function c(){const s=t;let i=this.property,r=this.getValue(),o=e.object;null!=o[s(341)]&&(o.style.backgroundColor=null),o[i]=r,n[s(296)]()}function h(){const s=t;let i=this[s(314)],r=this[s(343)](),o=e[s(295)];i===s(297)?null==r||""===r?r=null:typeof r==s(385)&&(r=r[s(292)](",")):i===s(332)&&e[s(295)][s(344)]&&(r=null),null!=o[s(341)]&&(o[s(338)][s(332)]=null),o[s(342)](i,r),n[s(296)]()}const u=this.newFolder(t(360));u[t(305)](i,t(299))[t(312)](c)[t(299)](t(299)),u[t(305)](i,t(317))[t(312)](c)[t(299)]("文字"),u[t(305)](r,t(384),0,1,.1)[t(315)](h).name(t(321)),u[t(305)](r,t(380))[t(312)](h).name(t(377)),u.open();const d=this[t(358)](t(390));d.add(i,"x")[t(312)](c),d[t(305)](i,"y")[t(312)](c),d[t(305)](i,t(382),1)[t(312)](c)[t(299)]("宽度"),d[t(305)](i,t(324),1).onFinishChange(c)[t(299)]("高度"),d[t(305)](r,t(322),0,10).onChange(h)[t(299)](t(353)),d[t(305)](r,t(368),0,10)[t(315)](h)[t(299)](t(373)),d[t(305)](r,"lineDash",o).onChange(h)[t(299)]("虚实"),d[t(305)](r,"fillStyle")[t(312)](h)[t(299)](t(293)),d[t(305)](i,"imageSrc")[t(312)](c)[t(299)](t(330)),d[t(326)]();const p=this[t(358)](t(301));p[t(305)](r,t(368),0,100)[t(315)](h).name(t(373)),p.add(r,t(297),o).onChange(h)[t(299)]("虚实"),p[t(305)](r,t(345),l)[t(315)](h)[t(299)]("末端样式"),p[t(326)]();const f=this[t(358)]("文本");f.add(r,"fontFamily",a)[t(315)](h)[t(299)]("字体名称"),f[t(305)](r,t(383),1,1e3)[t(315)](h)[t(299)]("大小"),f[t(305)](r,"color").onChange(h)[t(299)]("颜色"),f[t(326)]();let g=this[t(359)][t(329)];g.remove(),s[t(355)][t(304)](g),g[t(338)][t(320)]=t(386),g[t(338)][t(323)]=t(328),g[t(338)][t(376)]=t(366),g[t(338)][t(289)]=1e3}[N(326)](){const t=N;this[t(359)][t(326)]()}close(){const t=N;this.gui[t(387)]()}[N(300)](){const t=N;this[t(359)][t(329)].style[t(351)]=t(381)}[N(350)](){const t=N;this[t(359)].domElement[t(338)][t(351)]=t(325)}}const F=R;function R(t,e){const n=W();return(R=function(t,e){return n[t-=438]})(t,e)}!function(t,e){const n=R,s=W();for(;;)try{if(620625===parseInt(n(449))/1+parseInt(n(440))/2*(-parseInt(n(447))/3)+parseInt(n(446))/4*(parseInt(n(453))/5)+-parseInt(n(463))/6+-parseInt(n(444))/7+-parseInt(n(455))/8*(parseInt(n(441))/9)+parseInt(n(439))/10*(parseInt(n(461))/11))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const V=-1!==navigator[F(443)][F(459)]()[F(454)](F(460))?F(450):"Control",K={CtrlOrCmd:V,CreateGroup:V,DropTo_leader:F(442),Delete:["Delete",F(462)],Select_all:[V+"+a"],Select_invert:[V+"+i"],Cut:[V+"+x"],Copy:[V+"+c"],Paste:[V+"+v"],Save:[V+"+s"],Open:[V+"+o"],Undo:[V+"+z"],Redo:[V+"+shift+z"],Copy_style:[F(445)],paste_Style:[F(464)],Move_up:[F(457)],Move_down:[F(451)],Move_left:[F(452)],Move_right:[F(456)],Layout_tree:["t"],Layout_grid:["g"],LocalView:["/"],ResizeKeepAspectRatio:F(438),DrawLine:["l"],Cancel:[F(448)],DiableNodeAlign:F(458)};function W(){const t=["Meta","ArrowDown","ArrowLeft","30brsWjE","indexOf","8zpbZmW","ArrowRight","ArrowUp","Alt","toUpperCase","MAC OS","26781227tKdZeO","Meta+Backspace","1112604PgfJXj","Shift+v","shift","10jpVQEf","92326EvYxkw","4734441MLivHf","Shift","userAgent","6120639TNvJJk","Shift+c","19080owUhVq","33OZqBiB","Escape","251001ttRiUv"];return(W=function(){return t})()}function _(t,e){const n=Z();return(_=function(t,e){return n[t-=377]})(t,e)}function Z(){const t=["1px solid black","50zwGSrL","222RqeAZJ","gray","5254733EJRUZb","260425qpDqgL","937344wpuWUj","1801373uVkhgO","88722apOBEy","614360vvEjir","pink","#ecb645","16SzHPiB","rgba(0,0,0,0.1)","rgba(255,255,255,0.6)","rgba(0,0,0,0.9)","3px solid orange","6bXIcnQ","orange","black","33365TVvicQ"];return(Z=function(){return t})()}const X=_;!function(t,e){const n=_,s=Z();for(;;)try{if(259569===parseInt(n(378))/1+-parseInt(n(379))/2+-parseInt(n(390))/3*(-parseInt(n(382))/4)+-parseInt(n(393))/5*(-parseInt(n(396))/6)+-parseInt(n(380))/7*(parseInt(n(385))/8)+parseInt(n(381))/9*(-parseInt(n(395))/10)+parseInt(n(377))/11)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const U={data:{localLastDocName:"topo_last_doc"},anchorPoint:{size:11,style:{strokeStyle:X(397),fillStyle:X(387),lineWidth:1},activeStyle:{fillStyle:"red"},unActiveStyle:{fillStyle:"rgba(255,255,255,0.6)"},drawStartMinDistance:11,drawStartDelay:200},anchorBox:{anchorDist:5.5,nodeDist:12},nodeResizePoint:{width:12,height:12,style:{border:X(394),backgroundColor:X(391)}},nodeRotatePoint:{width:14,height:14,style:{lineWidth:1,strokeStyle:X(392),fillStyle:X(391)},rotateLineStyle:{strokeStyle:X(397)},rotateLineLength:30},guildLine:{styleW:{strokeStyle:X(384),lineDash:[1,1]},styleS:{strokeStyle:X(384),lineDash:[1,1]}},linkCtrlPoint:{size:7,style:{lineWidth:1,strokeStyle:"gray",fillStyle:X(383)},activeStyle:{strokeStyle:X(386),fillStyle:"rgba(0,0,0,0.1)"},unactiveStyle:{strokeStyle:X(388),fillStyle:X(383)},adjustStyle:{strokeStyle:X(397),fillStyle:X(391)},ctrlLinkStyle:{lineDash:[2,2]}},dropBox:{style:{border:X(389),lineDash:[5,3]}},align:{minDistance:10,alignLineStyle:{strokeStyle:X(391),lineDash:[5,3]}},operationTip:{enable:!0}},q=J;function J(t,e){const n=Q();return(J=function(t,e){return n[t-=387]})(t,e)}function Q(){const t=["3cuKsob","lineDrawingFinished","active","update","setCursor","isDragStart","lineDrawn","drawStartDelay","画线开始","21fUWnSd","now","css","28510ilnUHQ","mouseenterHandler","beginEndpoint","mousemoveHandler","anchorPoint","440UJMENP","setEnd","intersectNode","style","rate","resizeTo","end","findConnectableEndpoint","assert","size","parent","unactive","isIntersectPoint","segIndex","stageToLocalXY","showTip","target","4870665NvrtcP","recordEnd","drawStartInfo","crosshair","stage","link","122635bYDlmG","timeStamp","setIntersect","record","distancePoint","instanceManager","2212779PDuJyD","inputSystem","dragHandler","69080vngipr","editor","5243424tvsvfU","946520ofiQKE","endpoint","auto","anchorBox","isActive","36MgBwNI","4FomzpS","drawStartMinDistance","buttons","intersect","activedPoint","name","show"];return(Q=function(){return t})()}!function(t,e){const n=J,s=Q();for(;;)try{if(623483===parseInt(n(392))/1*(-parseInt(n(441))/2)+-parseInt(n(438))/3*(-parseInt(n(450))/4)+parseInt(n(432))/5*(-parseInt(n(449))/6)+parseInt(n(401))/7*(parseInt(n(444))/8)+-parseInt(n(426))/9+-parseInt(n(404))/10*(parseInt(n(409))/11)+parseInt(n(443))/12)break;s.push(s.shift())}catch(t){s.push(s.shift())}}(),q(411);class Y extends e{constructor(t,e=0,n=0,s=1,i=1){const r=q;super(null,e,n,s,i),this[r(448)]=!1,this[r(421)]=!1,this.anchorBox=t,this.editor=t.editor,this[r(430)]=this.editor.stage,this[r(414)](U.anchorPoint[r(418)],U[r(408)][r(418)]),this.css(U[r(408)][r(412)]),this[r(420)]()}[q(434)](t){this.intersect=t}[q(405)](){this[q(394)]()}mouseoutHandler(){const t=q;this[t(430)].setCursor(t(446)),this[t(420)]()}[q(407)](){}mousedownHandler(t){const e=q;t.preventDefault(),this[e(442)][e(430)][e(396)](e(429)),this[e(431)]=null}[q(440)](t){const e=q;if(2===t[e(387)])return;const r=this[e(442)],o=r[e(430)];this.anchorBox[e(389)]&&this[e(447)][e(389)][e(420)]();const a=this[e(447)][e(425)];if(t[e(397)]){let i;if(this.isIntersectPoint){let t=this[e(447)][e(388)];i=new n(a,t[e(413)],t[e(422)])}else i=new s(a,this[e(390)]);this[e(428)]={x:t.x,y:t.y,beginEndpoint:i,timeStamp:Date[e(402)]()}}else{if(null!=this[e(428)]){let n=i[e(436)](this[e(428)],t);if(Date[e(402)]()-this[e(428)][e(433)]>U.anchorPoint[e(399)]&&n>U.anchorPoint[e(451)]){this.editor[e(424)](e(400)),console[e(417)](null==this[e(431)],this.link),this[e(442)][e(435)]("划线");const t=r.instanceManager[e(398)](null,a,null,this.drawStartInfo[e(406)]);this[e(431)]=t;let n=t[e(419)][e(423)](o[e(439)].x,o.inputSystem.y);t[e(410)](n),this.drawStartInfo=null}}if(null!=this[e(431)]&&null!=this[e(431)].end){let t=this[e(431)][e(419)][e(423)](o[e(439)].x,o.inputSystem.y);this[e(431)].setEnd(t),this[e(445)]=this[e(447)][e(416)]([this[e(431)],this[e(431)][e(415)].target])}}}mouseupHandler(t){const e=q;this[e(391)](),this[e(442)][e(395)](),this.editor[e(430)].setCursor(e(446)),null!=this[e(431)]&&(this[e(445)]&&(this[e(431)].setEnd(this[e(445)]),this.link.upgradeParent(),this[e(431)].updateMatrix()),this[e(442)][e(437)][e(393)](this[e(431)]),this[e(447)][e(416)]([]),this[e(442)][e(427)]("划线")),this.link=null}active(){const t=q;this[t(448)]=!0,this[t(403)](U.anchorPoint.activeStyle)}[q(420)](){const t=q;this.isActive=!1,this[t(403)](U[t(408)].unActiveStyle)}}const $=tt;function tt(t,e){const n=nt();return(tt=function(t,e){return n[t-=402]})(t,e)}!function(t,e){const n=tt,s=nt();for(;;)try{if(140405===-parseInt(n(402))/1*(parseInt(n(418))/2)+-parseInt(n(425))/3*(-parseInt(n(407))/4)+parseInt(n(415))/5+-parseInt(n(410))/6*(parseInt(n(409))/7)+parseInt(n(404))/8*(-parseInt(n(413))/9)+-parseInt(n(423))/10*(-parseInt(n(411))/11)+parseInt(n(417))/12)break;s.push(s.shift())}catch(t){s.push(s.shift())}}(),$(419),$(405),$(421),$(416),$(403),$(412),$(420),$(424),$(408),$(414),$(406);class et{constructor(t){this[$(422)]=t}}function nt(){const t=["delete","open","cut","type","20ZlCQHN","create","37008zuDwtm","1VdYVIA","resize","8ZEiZKg","copy","drawLineEnd","68dQgOus","lineDrawingFinished","14NANLHk","808212LzShXJ","604703nMrzky","save","1780983LtwUol","drawLineStart","573790iAGhOC","paste","4389672mKjkuK","385052kGtAcy"];return(nt=function(){return t})()}const st=it;function it(t,e){const n=at();return(it=function(t,e){return n[t-=307]})(t,e)}function rt(t,e){const n=it;let s=e[n(309)],i=t.positionToLocalPoint(n(338));return i=t.getStageTransform()[n(341)](i),Math[n(339)](s.y-i.y,s.x-i.x)}!function(t,e){const n=it,s=at();for(;;)try{if(246015===-parseInt(n(328))/1+parseInt(n(327))/2*(-parseInt(n(315))/3)+parseInt(n(318))/4+parseInt(n(333))/5*(parseInt(n(329))/6)+parseInt(n(317))/7*(-parseInt(n(319))/8)+parseInt(n(316))/9+-parseInt(n(348))/10*(-parseInt(n(337))/11))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();class ot extends r{constructor(t,e){const n=it;super(),this[n(332)]=t[n(332)],this[n(343)]=this[n(332)][n(343)],this[n(307)]=this[n(343)].selectedGroup,this[n(344)](U[n(347)][n(312)]),this[n(322)](U[n(347)][n(331)],U[n(347)][n(336)]),this[n(345)]=e}[st(326)](){const t=st;this.stage.setCursor(o[t(334)])}[st(310)](t){const e=st;t.preventDefault();let n=this[e(343)];if(0===this[e(307)][e(330)]()[e(342)])throw new Error(e(335));let s=n[e(309)].target;this[e(340)]=s.rotation,this[e(325)]=rt(s,n)}[st(320)](t){const e=st;this[e(343)].setCursor(e(308)),t[e(321)]()}[st(314)](t){const e=st;t[e(321)]();let n=this[e(323)],s=n[e(332)],i=s.stage;if(0===s[e(343)][e(307)][e(330)]().length)throw new Error(e(335));let r=i[e(309)].target,o=rt(r,i)-this[e(325)];if(r[e(313)](this[e(340)]+o),n[e(311)](),0!==o){let t=new et("rotate");t[e(346)]=r,t.details={dAngle:o},s[e(324)](t)}}}function at(){const t=["10KywSAg","selectedGroup","auto","inputSystem","mousedownHandler","updateSize","style","rotate","dragHandler","6sSfvSN","2414682mSmJoA","156954dlSots","1512528QriMEa","136DiYzNz","mouseupHandler","preventDefault","resizeTo","parent","dispatchEvent","mouseInitAngle","mousemoveHandler","430816YgwOKU","283607JxZSBr","4362AWHgmP","getNoChildrensObjects","width","editor","2455GaLKxh","move","selectedGroup.length is 0!","height","3720475VpJLym","center","atan2","elementInitAngle","point","length","stage","css","name","object","nodeRotatePoint"];return(at=function(){return t})()}const lt=ht;function ct(){const t=["width","mousemoveHandler","4782FvCKlD","24twTImq","nodeResizePoint","details","339392dQsdly","getNoChildrensObjects","1565gxKmpo","updateSize","target","6cMnxHJ","inputSystem","positionToLocalPoint","24oglCSu","selectedGroup.length is 0!","editor","9JSCibz","style","keyboard","resizeWith","mouseupHandler","selectedGroup","adjustFixedDirection","height","setCursor","object","92665jqvjdU","name","translateWith","2268728IqqxUo","mousedownHandler","mouseenterHandler","86072wSrodF","w-resize","nw-resize","nodeCtrlBox","s-resize","7304099ReTpAj","n-resize","ResizeKeepAspectRatio","dragHandler","4582540TdIjby","sw-resize","stage","preventDefault","mouseoutHandler","e-resize","ne-resize","resize","dispatchEvent","stageToLocalXY","transformPoint"];return(ct=function(){return t})()}function ht(t,e){const n=ct();return(ht=function(t,e){return n[t-=157]})(t,e)}!function(t,e){const n=ht,s=ct();for(;;)try{if(607771===parseInt(n(164))/1*(parseInt(n(201))/2)+parseInt(n(193))/3*(parseInt(n(196))/4)+-parseInt(n(198))/5*(-parseInt(n(192))/6)+-parseInt(n(170))/7+-parseInt(n(167))/8*(-parseInt(n(207))/9)+parseInt(n(179))/10+parseInt(n(175))/11*(-parseInt(n(204))/12))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();class ut extends e{constructor(t,e){const n=ht;super(),this[n(173)]=t,this.editor=t[n(206)],this.stage=this.editor[n(181)],this.selectedGroup=this[n(181)].selectedGroup,this.resizeTo(U[n(194)].width,U[n(194)].height),this.css(U[n(194)][n(208)]),this[n(165)]=e}[lt(169)](){}[lt(191)](){const t=lt;let e,n=this[t(165)];n===a.lt?e=t(172):n===a.ct?e=t(176):n===a.rt?e=t(185):n===a.lm?e=t(171):n===a.rm?e=t(184):n===a.lb?e=t(180):n===a.cb?e=t(174):n===a.rb&&(e="se-resize"),this[t(206)].stage[t(162)](e)}[lt(183)](t){}[lt(168)](t){t[lt(182)]()}[lt(158)](t){t.preventDefault()}[lt(178)](t){const e=lt;let n=this[e(173)][e(206)],s=n[e(181)],i=this[e(165)];if(0===this[e(159)][e(197)]().length)throw new Error(e(205));let r=s[e(202)][e(200)],o=r[e(188)](t.x,t.y),l=r.positionToLocalPoint(i),c=o.x-l.x,h=o.y-l.y;if(i===a.lt?(c=-c,h=-h):i===a.ct?(c=0,h=-h):i===a.rt?h=-h:i===a.lm?(c=-c,h=0):i===a.rm?h=0:i===a.lb?c=-c:i===a.cb?c=0:a.rb,n[e(209)].isKeydown(K[e(177)])){h=c*(r[e(161)]/(r[e(190)]||1))}if(this[e(160)](r,{dx:c,dy:h},i),0!==c&&0!==h){let t=new et(e(186));t[e(163)]=r,t[e(195)]={dx:c,dy:h,ctrl:i},n[e(187)](t)}}[lt(160)](t,e,n){const s=lt;let i=l[n],r=t[s(203)](i);r=t[s(189)](r),t[s(157)](e.dx,e.dy);let o=t[s(203)](i);o=t[s(189)](o);let a=r.x-o.x,c=r.y-o.y;t[s(166)](a,c),this.nodeCtrlBox[s(199)]()}}const dt=pt;function pt(t,e){const n=gt();return(pt=function(t,e){return n[t-=127]})(t,e)}!function(t,e){const n=pt,s=gt();for(;;)try{if(806979===-parseInt(n(160))/1+-parseInt(n(146))/2+parseInt(n(159))/3+-parseInt(n(131))/4*(-parseInt(n(166))/5)+-parseInt(n(163))/6+-parseInt(n(135))/7+parseInt(n(148))/8)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();class ft extends e{constructor(t,e=0,n=0,s=1,i=1){const r=pt;super(null,e,n,s,i),this[r(169)]=c.NodeCtrlBox,this[r(152)]=t,this.mouseEnabled=!1,this[r(129)]()}[dt(143)](){const t=dt;this.visible&&this[t(165)]()}[dt(157)](){}[dt(150)](){}[dt(158)](t){const e=dt;this[e(134)]();let n=t[e(138)](),s=this;n[e(137)]((t=>{const n=e;if(s.createCtrlPoint(t),t===n(141)){let t=function(){return s[n(149)](a.ct)},e=s[n(136)](n(141)),i=new h(null,e,t);i[n(167)](U[n(161)].rotateLineStyle),i.mouseEnabled=!1,s[n(162)](i)}}))}[dt(136)](t){let e;return e="rotate"===t?new ot(this,t):new ut(this,t),this.addChild(e),e}clearTarget(){const t=dt;this[t(144)]=null,this[t(129)]()}[dt(155)](t){const e=dt;if(!function(t){const e=pt;let n=t.parent;return n instanceof h&&(n[e(130)]===t||n.endArrow===t)}(t)){if(!0!==t.editable)throw new Error(e(132));null!==this[e(144)]&&this[e(158)](t),this[e(144)]=t,this[e(165)](),this[e(140)]()}}[dt(165)](){const t=dt;let e=this[t(144)];if(null==e||!1===e[t(168)]||null==e[t(156)])return this[t(144)]=null,void this[t(129)]();this[t(145)](e),this[t(164)]()}[dt(164)](){const t=dt;let n=this[t(154)]();for(let s=0;s<n[t(153)];s++){let i,r=n[s];r instanceof h||(r[t(133)]===t(141)?(i=this.positionToLocalPoint(a.ct),i.y-=U.nodeRotatePoint[t(147)]):i=this[t(149)](r[t(133)]),r instanceof e&&r.translateTo(i.x,i.y))}}[dt(145)](t){const e=dt;let n=t[e(128)](),s=n[e(127)](t[e(149)](a.center)),i=n.point(t[e(149)](a.rm)),r=Math.atan2(i.y-s.y,i.x-s.x);n.rotate(-r);let o=n[e(127)](t.positionToLocalPoint(a[e(139)])),l=n.point(t[e(149)](a.rb)),c=2*(l.x-o.x),h=2*(l.y-o.y);this[e(142)](c,h),this.rotate(r),this[e(151)](s.x,s.y)}}function gt(){const t=["length","getChildren","attachTo","parent","mouseoutStageHandler","initCtrlPoint","196101ZYBMCV","1203896nqCIlv","nodeRotatePoint","addChild","3853800zsUtIi","initPoints","updateSize","388845xKncLN","css","isSelected","zIndex","point","getStageTransform","hide","beginArrow","4FdLAVp","attach not Node or not editable","name","removeAllChild","1371944tVKGSe","createCtrlPoint","forEach","getCtrlPoints","center","show","rotate","resizeTo","update","currNode","viewClone","764972QmBcNZ","rotateLineLength","24708136BVvkpw","positionToLocalPoint","mouseenterStageHandler","translateTo","editor"];return(gt=function(){return t})()}function yt(t,e){const n=It();return(yt=function(t,e){return n[t-=124]})(t,e)}function It(){const t=["isActive","hide","stageToLocalXY","setCtrlPoint1","60634GQwkFU","ctrlPoint2","setCtrlPoint","getK","target","activeStyle","center","ctrlPoint","w_resize","positionToLocalPoint","ctrlPoint1","fold1","canConnectEndpoint","css","608592gIZQke","1160365sitnAO","e_resize","132714gtLjXI","setFold1Offset","name","fold2","begin","active","976OahDve","anchorBox","1212832vkKRWQ","size","inputSystem","unactiveStyle","crosshair","unActive","setCtrlPoint2","setBegin","s_resize","mouseupHandler","setCursor","preventDefault","points","parent","n_resize","isDragStart","mousedownHandler","stage","413209qRXYqN","linkCtrlPoint","findConnectableEndpoint","dragHandler","setEnd","setCenterOffset","upgradeParent","move","452506XFZVBd","linkCtrlBox","editor","end","isConnectPoint","mousemoveHandler","updateMatrix","resetOffset","attachedLink"];return(It=function(){return t})()}const mt=yt;!function(t,e){const n=yt,s=It();for(;;)try{if(307692===-parseInt(n(186))/1+-parseInt(n(130))/2+-parseInt(n(157))/3+parseInt(n(168))/4+-parseInt(n(158))/5+parseInt(n(160))/6+-parseInt(n(143))/7*(-parseInt(n(166))/8))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();class bt extends r{constructor(t){const e=yt;super(),this[e(134)]=!0,this[e(139)]=!1,this.setRadius(U[e(187)][e(169)]),this.linkCtrlBox=t,this[e(132)]=this[e(131)][e(132)],this[e(156)](U[e(187)].style)}active(){const t=yt;this.css(U[t(187)][t(148)]),this[t(139)]=!0}unActive(){const t=yt;this[t(156)](U[t(187)][t(171)]),this.isActive=!1}[mt(135)](){const t=mt;this[t(132)][t(167)][t(140)](),this.editor.stage.setCursor(o[t(129)]);let e=this[t(181)],n=this[t(132)].stage,s=e[t(138)];if(s instanceof u){let e=null,i=s[t(180)][0],r=s[t(180)][1],l=s[t(180)][4],c=s.points[5];this[t(162)]===a[t(154)]?e=d(s.getK(0,.5))?r.x>i.x?o[t(151)]:o[t(159)]:r.y>i.y?o[t(176)]:o[t(182)]:this.name===a.fold2?e=d(s[t(146)](4,.5))?l.x>c.x?o[t(151)]:o[t(159)]:l.y>c.y?o[t(176)]:o[t(182)]:this[t(162)]===a.center&&(e=d(s[t(146)](2,.5))?o[t(176)]:o[t(159)]),e&&n[t(178)](e)}}[mt(184)](t){const e=mt;this[e(132)].stage.setCursor(e(172)),this.canConnectEndpoint=null}[mt(125)](t){const e=mt;let n=this[e(181)],s=n[e(181)].stage;const i=this.editor;let r=n[e(138)];i.anchorBox[e(140)]();const l=this[e(162)];this[e(132)].stage[e(178)](o[e(172)]);let c=r.parent[e(141)](s[e(170)].x,s[e(170)].y);if(t[e(183)]&&(l===a[e(164)]||l===a[e(133)])&&this[e(165)](),l===a[e(164)])return r instanceof u&&r[e(137)](),r[e(175)]({x:c.x,y:c.y}),r[e(136)](),void(this.canConnectEndpoint=i[e(167)].findConnectableEndpoint([r]));if(l===a[e(133)])return r instanceof u&&r[e(137)](),r[e(126)]({x:c.x,y:c.y}),r[e(136)](),void(this[e(155)]=i.anchorBox[e(124)]([r]));if(r instanceof p)this[e(162)]===a.ctrlPoint&&(null==r.ctrlPoint?r[e(145)](r[e(152)](l)):(r[e(150)].x+=c.x-r[e(150)].x,r[e(150)].y+=c.y-r[e(150)].y,r[e(145)](r[e(150)])));else if(r instanceof f)l===a[e(153)]?null==r.ctrlPoint1?r[e(142)](r[e(152)](l)):(r[e(153)].x+=c.x-r[e(153)].x,r[e(153)].y+=c.y-r.ctrlPoint1.y,r[e(142)](r[e(153)])):l===a[e(144)]&&(null==r[e(144)]?r[e(174)](r[e(152)](l)):(r.ctrlPoint2.x+=c.x-r[e(144)].x,r[e(144)].y+=c.y-r.ctrlPoint2.y,r.setCtrlPoint2(r[e(144)])));else if(r instanceof u)if(l===a[e(154)]){let t=r[e(152)](a[e(154)]);const n=c.x-t.x,s=c.y-t.y;r[e(161)](n,s),r[e(136)]()}else if(l===a[e(149)]){let t=r[e(152)](a[e(149)]);const n=c.x-t.x,s=c.y-t.y;r[e(127)](n,s),r.updateMatrix()}else if(l===a[e(163)]){let t=r[e(152)](a.fold2);const n=c.x-t.x,s=c.y-t.y;r.setFold2Offset(n,s),r[e(136)]()}}[mt(177)](t){const e=mt;this[e(132)][e(185)][e(178)](o.auto),t.event[e(179)](),this[e(139)]&&this[e(173)]();let n=this.parent[e(138)];if(null!=this.canConnectEndpoint){let t=this[e(155)],s=t[e(147)];if(s.isLink){let i=s;i.end[e(147)]!==n&&i[e(164)][e(147)]!==n&&(this[e(162)]===a[e(164)]?n.setBegin(i,t):this[e(162)]===a[e(133)]&&n[e(126)](i,t),n.upgradeParent(),n.updateMatrix())}else this[e(162)]===a[e(164)]?n[e(175)](s,t):this[e(162)]===a[e(133)]&&n.setEnd(s,t),n[e(128)](),n[e(136)]();this[e(155)]=null}}}const wt=Ct;function xt(){const t=["fillColor","ctrlPoint1","background","point","anchorNameStr","addChild","center","1544tPzwqy","linkCtrlPoint","hideAllPoint","init","updateSize","length","clearTarget","ctrlPoint","hide","ctrlPoint2","3648432aHNyjH","inputSystem","4FYIooe","updateFllow","23598810mgSTgH","removeAllChild","matrixDirty","css","getCtrlPoints","getStageTransform","mouseenterStageHandler","ctrlPointStyle","ctrlPointInfo","2989398ZhHNoj","translateTo","draw","3447130zDZOXZ","createNodeResizePoint","setBegin","parent","ctrlLinkStyle","target","name","attachedLink","editor","mouseoutStageHandler","stage","7791882oHabiX","7bbygVa","Link","visible","updateCtrlPoints","9485730bbVWun","attachTo","1814ofEXCQ","join","isConnectPoint","zIndex","begin","LinkCtrlBox","setEnd","end"];return(xt=function(){return t})()}function Ct(t,e){const n=xt();return(Ct=function(t,e){return n[t-=290]})(t,e)}!function(t,e){const n=Ct,s=xt();for(;;)try{if(734274===parseInt(n(303))/1*(-parseInt(n(318))/2)+parseInt(n(341))/3+parseInt(n(330))/4*(parseInt(n(344))/5)+parseInt(n(296))/6+parseInt(n(297))/7*(parseInt(n(328))/8)+parseInt(n(301))/9+-parseInt(n(332))/10)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();class St extends e{constructor(t){const e=Ct;super(),this[e(340)]={},this[e(306)]=c[e(308)],this[e(293)]=t,this[e(339)]=new g({}),this[e(321)]()}[wt(294)](){}[wt(338)](){}[wt(345)](t){const e=wt;let n=new bt(this);return n[e(291)]=t,this[e(316)](n),n}[wt(321)](){const t=wt;this.ctrlPointInfo={},this[t(326)]()}[wt(343)](t){const e=wt;!1!==this[e(299)]&&this[e(322)]()}[wt(322)](){const t=wt,e=this[t(293)][t(295)][t(329)][t(290)];this[t(292)]?null==this.attachedLink[t(347)]||null==e||this[t(292)]!==e?(this[t(292)]=null,this.hide()):this[t(302)](this[t(292)]):this[t(326)]()}[wt(300)](t){const e=wt;this[e(292)]=t;let n=t[e(336)]();this[e(315)]=n.join(",");for(let t=0;t<n.length;t++){let s=n[t],i=this.ctrlPointInfo[s];if(null==i){if(i=this.createNodeResizePoint(s),s!==a[e(307)]&&s!==a.end&&(i[e(311)]=this[e(339)][e(313)],i[e(335)](U[e(319)].adjustStyle),i[e(305)]=!1),s===e(312)){let t=new h;t[e(335)](U[e(319)][e(348)]),t[e(346)](i,e(317));let n=this.ctrlPointInfo[e(307)];t[e(309)](n,e(317)),this[e(316)](t),this[e(340)][s+e(298)]=t}else if(s===e(327)){let t=new h;t.css(U[e(319)][e(348)]),t[e(346)](i,e(317));let n=this[e(340)][e(310)];t.setEnd(n,e(317)),this[e(316)](t),this[e(340)][s+e(298)]=t}else if(s===e(325)){let t=new h;t[e(335)](U.linkCtrlPoint.ctrlLinkStyle),t[e(346)](i,e(317));let n=this[e(340)][e(307)];t[e(309)](n,e(317)),this[e(316)](t),this[e(340)][s+e(298)]=t}this[e(340)][s]=i}}}[wt(320)](){const t=wt;let e=this[t(340)];for(let n in e)e[n][t(326)]()}updateFllow(){const t=wt,e=this.attachedLink;let n=e[t(337)](),s=e[t(336)]();this[t(320)]();for(let i=0;i<s[t(323)];i++){const r=s[i];let o=this[t(340)][r];if(null==o)continue;let a=e.positionToLocalPoint(r),l=n[t(314)](a);o[t(342)](l.x,l.y),o.show();let c=this[t(340)][r+t(298)];c&&c.show()}}[wt(302)](t){const e=wt;if(this[e(334)]=!0,null!=t.parent){if(this[e(292)]===t)return t instanceof u&&t.getCtrlPoints()[e(304)](",")!==this[e(315)]&&this.updateCtrlPoints(t),this[e(331)](),void this.show();this[e(340)]={},this.removeAllChild(),this[e(300)](t),this[e(331)](),this.show()}}[wt(324)](){const t=wt;this.attachedLink=null,this[t(340)]={},this[t(333)](),this[t(326)]()}}const vt=kt;function kt(t,e){const n=Ht();return(kt=function(t,e){return n[t-=146]})(t,e)}!function(t,e){const n=kt,s=Ht();for(;;)try{if(352009===parseInt(n(210))/1+parseInt(n(204))/2+parseInt(n(154))/3+-parseInt(n(155))/4*(parseInt(n(194))/5)+-parseInt(n(171))/6*(parseInt(n(203))/7)+parseInt(n(213))/8*(-parseInt(n(196))/9)+parseInt(n(158))/10)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();class Lt extends e{constructor(t,e=0,n=0,s=1,i=1){const r=kt;super(null,e,n,s,i),this[r(193)]=t,this[r(170)]=this[r(206)]("intersectNode"),this.ctrlIntersectPoint[r(211)]=!0,this[r(170)][r(167)]()}[vt(201)](){}mouseoutStageHandler(){}[vt(183)](){}[vt(205)](){const t=vt;this[t(184)]=null,this[t(167)]()}[vt(169)](t){const n=vt;if(this[n(151)](t)){if(this.target!==t){if(this.target=t,null!=t&&(t instanceof e||t instanceof h)){let e=t[n(180)]();if(this[n(165)][n(153)]-1!=e[n(153)]){this[n(165)][n(153)]=1;for(var s=0;s<e[n(153)];s++){let t=e[s];this[n(206)](t)}}}this.update()}this[n(165)][n(187)]((t=>t.unactive())),this[n(170)][n(167)](),this[n(197)]()}}[vt(151)](t){const e=vt;return null!=t&&!function(t){let e=t[kt(191)];return e instanceof h&&(e.beginArrow===t||e.endArrow===t)}(t)&&(t[e(150)]&&t.mouseEnabled&&t[e(174)]&&t[e(147)])}setTargetWithName(t,e){const n=vt;if(null==e)throw new Error("activeNameOrPoint is null");this[n(169)](t),this[n(176)](e),this[n(197)]()}[vt(200)](){const t=vt;this.activedPoint&&this.activedPoint[t(214)](),this.ctrlIntersectPoint.hide()}[vt(176)](t){const e=vt;this[e(164)]&&this[e(164)][e(214)]();let n=this[e(165)][e(188)]((n=>n[e(212)]==t))[0];this.activedPoint=n,n[e(186)](),this.ctrlIntersectPoint.hide()}[vt(157)](t){const e=vt;if(this[e(207)]=t,null==t)return void this[e(170)][e(167)]();let n=t[e(152)],s=t[e(217)];const i=this[e(184)];let r=i.getLocalPoint(n,s),o=i.getStageTransform()[e(218)](r);this.ctrlIntersectPoint[e(162)](o.x,o.y),this.ctrlIntersectPoint[e(160)](U[e(149)].activeStyle),this.ctrlIntersectPoint.show()}[vt(192)](){const t=vt;if(null==this[t(184)]||null==this[t(184)][t(191)])return void this[t(205)]();const e=this[t(184)],n=e[t(202)](),s=this.children;for(let i=0;i<s[t(153)];i++){const r=s[i],o=r[t(212)];if(!r[t(211)]){let s=e.positionToLocalPoint(o),i=n[t(218)](s);r[t(162)](i.x,i.y)}}}[vt(206)](t){const e=vt,n=new Y(this);return n.name=t,n[e(179)]=this,this.addChild(n),n}[vt(173)](t){const e=vt;let n=this.editor.stage,s=this[e(193)][e(168)](),i={x:n.inputSystem.x,y:n.inputSystem.y};return y(s,i,t,U[e(179)].nodeDist)}[vt(209)](t){const r=vt,o=this.editor,a=this,l=o[r(178)],c=l[r(156)],u={x:c.x,y:c.y},d=I(u,t,U[r(149)][r(181)]/2),p=o[r(166)][r(177)]();if(0==d[r(153)]&&!p){let t=function(t,e){const n=kt,s=t[n(168)](),r={x:s.mouseX,y:s[n(148)]};let o=s[n(216)][n(188)]((t=>t[n(189)])),a=o[n(175)](((t,e)=>{const s=n;let o=t[s(195)][s(208)].getCenter();return{index:e,dist:i[s(199)](r,o)}}));return a=a[n(188)]((t=>t[n(198)]<=e)),0==a[n(153)]?null:(a[n(163)](((t,e)=>t[n(198)]-e[n(198)])),o[a[0][n(190)]])}(l,100);return this.canConnectable(t)&&a.setTarget(t),null}if(d[r(153)]>0){d.sort(((t,n)=>{const s=r;let i=t[s(185)],o=n[s(185)];if(p){return(i instanceof h?0:1)-(o instanceof h?0:1)}return(i instanceof e?0:1)-(o instanceof e?0:1)}));const t=d[0],n=t[r(185)];let i=t[r(146)];const o=new s(n,i);return a.setTargetWithName(n,i),o}const f=this[r(173)](t);if(null!=f){const t=f[r(185)];a[r(169)](t);const e=new n(t,f.rate,f[r(217)]);return this.showIntersectAnchor(f),e}return a[r(205)](),null}[vt(215)](t){const e=vt,n=this.editor,s=this;const i=n.stage[e(172)][e(161)]()[e(182)](null,(function(n){const i=e;return-1==t[i(159)](n)&&s[i(151)](n)}),!0);return this.getConnectableEndpointFromObjects(i)}}function Ht(){const t=["182189xYdmMJ","1048686fOWIdh","clearTarget","createAnchorPoint","intersect","aabb","getConnectableEndpointFromObjects","107593eIKeEe","isIntersectPoint","name","58088jOnjSz","unactive","findConnectableEndpoint","displayList","segIndex","point","anchorName","painted","mouseY","anchorPoint","visible","canConnectable","rate","length","824745fWgKXC","2630420wGSsht","inputSystem","showIntersectAnchor","4640230ZwIVca","indexOf","css","getObject","translateTo","sort","activedPoint","children","keyboard","hide","getCurrentLayer","setTarget","ctrlIntersectPoint","18MbGdLF","localView","getObjectsIntersect","connectable","map","activePointByName","isControlDown","stage","anchorBox","getAnchorPoints","size","_findChildren","mouseenterStageHandler","target","object","active","forEach","filter","isNode","index","parent","update","editor","5hMlNwN","_obb","351UIRzjL","show","dist","distancePoint","clearActived","cancel","getStageTransform"];return(Ht=function(){return t})()}function Pt(t,e){const n=Tt();return(Pt=function(t,e){return n[t-=303]})(t,e)}const Et=Pt;function Tt(){const t=["undo","338639hOwMgR","1264616cTxDHD","pop","4899420BCRfVM","52400IpVvLZ","辅助粘贴","4OXQfXT","copy","1695883qDrAvb","redo","push","redoHistory","length","type","18uZNcaI","undoFn","redoFn","779005wNRdRv","剪切粘贴","尺寸修改","连线调整","6VhakcU","editor","1318917mbdTle","位置改变","undoHistory"];return(Tt=function(){return t})()}!function(t,e){const n=Pt,s=Tt();for(;;)try{if(232620===parseInt(n(321))/1+parseInt(n(325))/2+-parseInt(n(317))/3*(-parseInt(n(327))/4)+-parseInt(n(311))/5*(parseInt(n(315))/6)+-parseInt(n(329))/7+-parseInt(n(322))/8*(-parseInt(n(308))/9)+-parseInt(n(324))/10)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const Dt={cut:"cut",copy:Et(328),delete:"删除",modify:"修改",addChild:"添加图元",pasteCopy:Et(326),pasteCut:Et(312),resize:Et(313),rotate:"旋转",dragNodeOrLink:Et(318),modifyLink:Et(314)};class jt{constructor(t,e,n){const s=Et;this[s(307)]=t,this.undoFn=n,this[s(310)]=e}[Et(303)](){this[Et(310)]()}[Et(320)](){this[Et(309)]()}}class Mt extends t{constructor(t){const e=Et;super(),this[e(316)]=t,this[e(319)]=[],this.redoHistory=[]}clear(){const t=Et;this[t(319)]=[],this[t(305)]=[]}[Et(304)](t,e,n){const s=Et;let i=new jt(t,e,n);return i[s(316)]=this[s(316)],this.redoHistory[s(306)]=0,this[s(319)][s(304)](i),i}undo(){const t=Et;if(0===this[t(319)][t(306)])return null;let e=this.undoHistory.pop();return e[t(320)](),this[t(305)][t(304)](e),e}[Et(303)](){const t=Et;if(0===this.redoHistory[t(306)])return null;let e=this[t(305)][t(323)]();return e[t(303)](),this.undoHistory[t(304)](e),e}undoAll(t=500){let e=this;!function n(){let s=e[Pt(320)]();e.editor.update(),null!=s&&setTimeout(n,t)}()}redoAll(t=500){let e=this;!function n(){const s=Pt;e[s(316)].update(),null!=e[s(303)]()&&setTimeout(n,t)}()}}const Ot=Nt;function zt(){const t=["复制样式","772040soMqhO","Layout_grid","Move_down","filter","getNoChildrensObjects","724383oyKQjA","toogleLocalView","Move_up","粘贴样式","forEach","pasteHandler","keyboard","clearCtrlBoxs","openLasted","update","KeysConfig","displayList","localView","editorEventManager","copyHandler","Move_right","removeAll","Select_invert","preventDefault","716646pDEjID","showOpTooltip","children","cutHandler","选编组-","length","inputSystem","doGridLayout","bindKey","Move_left","onEsc","Shift","stage","265wsqBhX","redoUndoSys","clipboardManager","imageToBase64","1618316pepsrk","editor","flatten","objects","isNode","Copy_style","parent","notContains","Cut","selectedGroup","centerBy","678412tlFRtR","Copy","styleCopyHandler","Undo","14004ZiwhHx","redo","127045ZHjZty","Save","addAll","select","layoutManager"];return(zt=function(){return t})()}function Nt(t,e){const n=zt();return(Nt=function(t,e){return n[t-=150]})(t,e)}!function(t,e){const n=Nt,s=zt();for(;;)try{if(252827===-parseInt(n(169))/1+parseInt(n(163))/2+parseInt(n(180))/3+-parseInt(n(167))/4*(parseInt(n(212))/5)+parseInt(n(199))/6+-parseInt(n(152))/7+parseInt(n(175))/8)break;s.push(s.shift())}catch(t){s.push(s.shift())}}(),Ot(210);class At{constructor(t){this[Ot(153)]=t,this.init()}init(){const t=Ot,e=this[t(153)],n=e.stage,s=e.currentLayer;let i=e.stage[t(186)];const r=e.KeysConfig;function o(e,n,s){e[t(184)]((t=>{i.bindKey(t,(function(t){n(t)}),s)}))}i.on("keydown",(function(){e[t(189)]()})),i.on("keyup",(function(t){e.update()})),o(r.Delete,(n=>e[t(193)].deleteHandler(n))),o(r[t(160)],(n=>e[t(150)][t(202)](n))),o(r[t(164)],(n=>{const s=t;e[s(200)]("复制"),e[s(150)][s(194)](n)})),o(r.Paste,(n=>e[t(150)][t(185)](n))),o(r[t(166)],(n=>{const s=t;e[s(200)]("撤销"),e[s(213)].undo(),e.clearCtrlBoxs()})),o(r.Redo,(n=>{const s=t;e[s(200)]("重做"),e[s(213)][s(168)](n),e[s(187)]()})),o(r.Select_all,(s=>{const i=t;e[i(200)]("全选");let r=n[i(192)].getObject(),o=m[i(154)](r[i(201)],(t=>1==t.visible));n.select(o)})),o(r[t(197)],(i=>{const r=t;e[r(200)]("反选");let o=n[r(161)].getNoChildrensObjects();n[r(172)](s[r(191)][r(178)]((t=>o[r(159)](t))))})),o(r[t(170)],(n=>{const s=t;e.showOpTooltip("保存"),e.saveHandler(n,e[s(151)])}),!1),o(r.Open,(n=>{const s=t;e[s(200)]("打开"),e[s(188)](n)}),!1),o(r.LocalView,(n=>{e[t(181)]()})),o(r[t(157)],(n=>{const s=t;e[s(200)](s(174)),e.clipboardManager[s(165)](n)}),!1),o(r.paste_Style,(n=>{const s=t;e[s(200)](s(183)),e[s(150)].stylePasteHandler(n)}),!1),o(r[t(208)],(e=>{const s=t;n[s(161)][s(179)]()[s(178)]((t=>t[s(156)]))[s(184)]((t=>{t.x-=1}))})),o(r[t(195)],(e=>{const s=t;n[s(161)][s(179)]()[s(178)]((t=>t.isNode)).forEach((t=>{t.x+=1}))})),o(r[t(182)],(e=>{const s=t;n[s(161)][s(179)]()[s(178)]((t=>t[s(156)]))[s(184)]((t=>{t.y-=1}))})),o(r[t(177)],(e=>{const s=t;n[s(161)].getNoChildrensObjects()[s(178)]((t=>t[s(156)]))[s(184)]((t=>{t.y+=1}))})),o(r[t(176)],(n=>{const s=t;e[s(173)][s(206)]()})),function(t,e,n){const s=Ot,i=t[s(186)];let r={};function o(e){const n=s;r[e]=t.stage[n(161)].objects.slice(),t[n(200)]("编组-"+e)}function a(e){const n=s;let i=r[e];if(i)return i=i[n(178)]((t=>null!==t[n(158)])),i[n(204)]>0&&(t[n(200)](n(203)+e),t.stage[n(161)][n(196)]()[n(171)](i),t[n(211)][n(205)].target=i[0]),i}for(let r=0;r<=9;r++)i[s(207)](""+t[s(190)].CreateGroup+r,(function(t){t.preventDefault(),o(r)})),i.bindKey(""+r,(function(t){t[s(198)](),a(r)})),i[s(207)](""+r+r,(function(t){const i=s;t[i(198)](),a(r)&&n[i(162)](e[i(161)][i(155)])}))}(e,n,s),o(r.Cancel,(n=>{e[t(209)](n)}))}}const Bt=Gt;function Gt(t,e){const n=Rt();return(Gt=function(t,e){return n[t-=147]})(t,e)}!function(t,e){const n=Gt,s=Rt();for(;;)try{if(121471===-parseInt(n(157))/1*(-parseInt(n(156))/2)+-parseInt(n(169))/3+-parseInt(n(164))/4+-parseInt(n(168))/5*(-parseInt(n(160))/6)+-parseInt(n(155))/7*(-parseInt(n(173))/8)+-parseInt(n(152))/9*(parseInt(n(176))/10)+parseInt(n(166))/11)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();class Ft{constructor(t){const e=Gt;this._disabled=!0,this[e(154)]=t,this[e(170)]()}[Bt(170)](){const t=Bt,e=this[t(154)],n=new h;n.mouseEnabled=!1,n.css(U[t(148)][t(175)]),n.hide(),this[t(174)]=n,e[t(163)][t(171)](this.guildlineW);const s=new h;s[t(147)]=!1,s.css(U[t(148)].styleS),s[t(167)](),this[t(158)]=s,e[t(163)].addChild(this[t(158)])}disable(){this[Bt(161)]=!0,this.hideGuidLine()}[Bt(159)](){this._disabled=!1}[Bt(153)](t){const e=Bt;if(this[e(161)])return;const n=this.editor[e(150)],s=this[e(174)],i=this[e(158)];s[e(165)]({x:0,y:t.y}),s[e(149)]({x:n[e(151)],y:t.y}),s[e(162)](),i[e(165)]({x:t.x,y:0}),i[e(149)]({x:t.x,y:n.height}),i[e(162)]()}[Bt(172)](){const t=Bt;this[t(174)].hide(),this[t(158)][t(167)]()}}function Rt(){const t=["6336WYqqBb","guildlineW","styleW","10bDYtJj","mouseEnabled","guildLine","setEnd","stage","width","2048769pqmNYF","showGuildLine","editor","1533NnzoGq","572wSasyB","95zNdMse","guildlineS","enable","8562KjnTGf","_disabled","show","handlerLayer","181596DxqksV","setBegin","4082166YujXmT","hide","210yfgOWM","711441DKrrRv","init","addChild","hideGuidLine"];return(Rt=function(){return t})()}function Vt(){var t=["copy","copyPut","4601560RiIGwj","take","source","104vZUqHT","48YuXmcZ","23903935JJKCyZ","904136gHMcQb","580617vssjhx","12JjFPDo","184492yKDbaq","134168phwWfG","10440250nTCXHH","type","3lWssKb","cutPut","cut"];return(Vt=function(){return t})()}function Kt(t,e){var n=Vt();return(Kt=function(t,e){return n[t-=182]})(t,e)}var Wt=Kt;!function(t,e){for(var n=Kt,s=Vt();;)try{if(611969===-parseInt(n(199))/1*(-parseInt(n(183))/2)+parseInt(n(186))/3*(parseInt(n(197))/4)+-parseInt(n(191))/5+parseInt(n(195))/6*(parseInt(n(182))/7)+-parseInt(n(194))/8*(parseInt(n(198))/9)+-parseInt(n(184))/10+parseInt(n(196))/11)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();class _t{constructor(){this[Kt(192)]=0}[Wt(190)](t){var e=Wt;this.take=0,this.type=e(189),this.source=t}[Wt(187)](t){var e=Wt;this[e(192)]=-1,this[e(185)]="cut",this[e(193)]=t}takeSource(){var t=Wt;return this[t(192)]++,this[t(193)]}isFirstCutPaste(){var t=Wt;return this[t(185)]===Dt[t(188)]&&0===this[t(192)]}}function Zt(t,e){const n=Ut();return(Zt=function(t,e){return n[t-=178]})(t,e)}const Xt=Zt;function Ut(){const t=["takeSource","jsonToObjects","map","recordEnd","forEach","cut","cutPut","stage","stageToLocalXY","4879764bDrKeF","pasteHandler","concat","stylePasteHandler","35psHfXB","粘贴样式","record","cssClipBoard","anchorBox","copyAndToJSON","className","1665MpDlFl","673624XgfWyk","nodeCtrlBox","editor","aabb","styleCopyHandler","serializerSystem","clearTarget","object","2619102ENEeqW","getCenter","copyHandler","7212fwuYXM","1003403bTsNOd","css","copySetStyle","1706378IeaCOE","10dDVQrq","inputSystem","objects","length","copyPut","getNoChildrensObjects","cutHandler","9533439MaBtnK","selectedGroup","style","addChild","dispatchEvent","clipboard","target","unionRects"];return(Ut=function(){return t})()}!function(t,e){const n=Zt,s=Ut();for(;;)try{if(558197===parseInt(n(218))/1+parseInt(n(221))/2+-parseInt(n(214))/3+parseInt(n(217))/4*(-parseInt(n(205))/5)+parseInt(n(194))/6+-parseInt(n(198))/7*(-parseInt(n(206))/8)+-parseInt(n(229))/9*(parseInt(n(222))/10))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();class qt{constructor(t){const e=Zt;this.cssClipBoard=new _t,this[e(182)]=new _t,this[e(201)]=new _t,this[e(208)]=t}[Xt(216)](){const t=Xt;let e=this.editor[t(192)],n=[][t(196)](e[t(178)][t(227)]());if(0===n[t(225)])return;let s=n.map((t=>t.parent));this[t(182)].copyPut([n,s]);let i=new et("copy");i.object=n,this[t(208)][t(181)](i)}[Xt(228)](){const t=Xt;let e=this[t(208)],n=e[t(192)],s=[][t(196)](n[t(178)][t(227)]());if(0===s.length)return;let i=s[t(187)]((t=>t.parent));this[t(182)][t(191)]([s,i]),e.record("剪切"),s[t(189)](((t,e)=>{i[e].removeChild(t),b.disconnect(t,s)})),e.recordEnd("剪切"),n[t(223)].target=null,e[t(202)][t(212)](),e[t(207)][t(212)](),e.linkCtrlBox[t(212)]();let r=new et(t(190));r[t(213)]=s,this[t(208)][t(181)](r)}[Xt(195)](){const t=Xt;let e=this[t(208)],n=this[t(182)].takeSource();if(null==n)return;let s=e.currentLayer,i=e[t(192)],r=n[0],o=n[1],a=r.map((e=>e._obb[t(209)])),l=w[t(184)](a)[t(215)](),c=s[t(193)](i[t(223)].x,i[t(223)].y),h=c.x-l.x,u=c.y-l.y;e[t(200)]("粘贴");let d=r,p=i[t(211)][t(203)](r);d=i[t(211)][t(186)](p),d.forEach(((t,e)=>{t.translateWith(h,u)})),d[t(189)](((e,n)=>{const s=t;o[n][s(180)](e)})),e[t(188)]("粘贴");let f=new et("paste");f[t(213)]=d,this[t(208)].dispatchEvent(f)}[Xt(210)](){const t=Xt;let e=this[t(208)].stage,n=e.inputSystem[t(183)];null==n&&(!e[t(178)].isEmpty()&&(n=e[t(178)].objects[0]),null==n)||this[t(201)][t(226)](n)}[Xt(197)](){const t=Xt;let e=this.editor,n=this[t(201)][t(185)]();if(null==n)return;let s=e[t(192)][t(178)][t(224)],i=this;e[t(200)]("粘贴样式"),s[t(189)]((e=>{i[t(220)](e,n)})),e[t(188)](t(199))}[Xt(220)](t,e){const n=Xt;t!==e&&t[n(204)]===e[n(204)]&&t[n(219)](e[n(179)])}}function Jt(){const t=["lineDrawingFinished","selectedGroupDragHandler","mouseupHandler","button","buttons","setCursor","showAt","mouseoutHandler","mousedragHandler","onLinkCreate","changeParent","dispatchEvent","round","4952588BuGUGI","isDragStart","mousedown","defaultPrevented","popupMenu","mousemove","deleteHandler","KeysConfig","isAncestors","getAllVisiable","editable","controlTarget","object","delete","length","localView","crosshair","getAABB","stage","target","onLineDrawnHandler","isOutOfParent","selectedGroup","setTarget","guidlineManager","mouseOverTarget","8586696QSskcq","recordEnd","editor","hide","mode","207MnKLxC","event","getObject","isLink","canConnectable","objects","112986uoFJyl","mousewheelHandler","currObject","Shift","init","getCurrentLayer","record","zoom","removeChild","DropTo_leader","inputSystem","dragHandler","getNoChildrensObjects","Control","drawLineEnd","filter","isSelected","attachTo","nodeCtrlBox","_cameraVisible","isMouseOn","clearTarget","dblclickHandler","groupdragend","linkCtrlBox","selectedGroupDragEndHandler","_obb","mousemoveHandler","upgradeLinks","addChild","forEach","isDragEnd","groupdrag","isNode","5740518bzBGcO","lineDrawn","379855HUSLFO","getCenter","30650TeffZx","parent","aabb","9AaVaWs","anchorBox","mouseoutStageHandler","modeChange","dropToBox","assert","keyboard","mousedownHandler","控制点","isKeydown","alignManager","showGuildLine","3242915ZLMhDO","findConnectableEndpoint","instanceManager","currentLayer","newMode","对象拖拽","mouseenterStageHandler","pickUpChild","move","handlerLayer","preventDefault"];return(Jt=function(){return t})()}const Qt=Yt;function Yt(t,e){const n=Jt();return(Yt=function(t,e){return n[t-=113]})(t,e)}!function(t,e){const n=Yt,s=Jt();for(;;)try{if(652058===-parseInt(n(215))/1+parseInt(n(217))/2*(parseInt(n(173))/3)+parseInt(n(142))/4+parseInt(n(118))/5+-parseInt(n(179))/6+-parseInt(n(213))/7+-parseInt(n(168))/8*(parseInt(n(220))/9))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const $t=null!=x.w?x.w.charAt(3):"1";function te(t,e){const n=Yt;let s,i=t[n(121)],r=t.currentLayer[n(151)]().filter((t=>t[n(212)]&&!0!==t[n(195)]&&t.mouseEnabled&&t[n(198)])),o=e.filter((t=>t[n(163)]()||t[n(218)]===i));for(let t=0;t<o.length;t++){if(s=ee(o[t],r),null!=s)break}return null==s&&(s=i,o=o[n(194)]((t=>t[n(218)]!==i))),console[n(225)](!0!==s[n(176)],!0,s),{parent:s,objects:o}}function ee(t,e){const n=Yt,s=t[n(159)](),i=e[n(194)]((e=>e!==t[n(218)]&&e!==t&&!t[n(150)](e)));for(let t=i.length-1;t>=0;t--){const e=i[t];if(e[n(159)]().isIntersectRect(s))return e}return null}class ne{constructor(t){this.editor=t,this.init()}[Qt(183)](){const t=Qt;let e=this[t(170)],n=e[t(160)],s=n[t(189)],i=e[t(127)];null==n[t(157)][t(172)]&&(n.camera.on(t(186),(function(){e.update()})),n.on(C[t(223)],(function(n){const s=t;let r=n[s(122)],o=e[s(197)],a=e[s(203)],l=e[s(224)],c=e[s(221)];r===S.edit?(i[s(208)](o),i[s(208)](a),i[s(208)](c),i[s(208)](l)):(i[s(187)](o),i[s(187)](a),i[s(187)](c),i[s(187)](l)),e.update()})),s.on("dragover",(function(n){const i=t;n[i(128)](),e[i(140)](s)})),s.on("drop",(function(){const n=t;s[n(174)].defaultPrevented||e[n(140)](s)})),s.on(t(144),(function(n){const i=t;s[i(174)].defaultPrevented||e[i(146)].hide()})),s.on("mouseup",(function(n){const i=t;2==s.button?!s[i(210)]&&e[i(146)][i(135)](s.x,s.y):e[i(146)][i(171)]()})),s.on(t(147),(function(){})),n.selectedGroup.on(C[t(211)],(function(t){e.selectedGroupDragHandler(t,n.selectedGroup.getNoChildrensObjects())})),n.selectedGroup.on(C[t(202)],(function(s){const i=t;e[i(204)](s,n[i(164)].getNoChildrensObjects())})))}[Qt(148)](){const t=Qt;let e=this.editor,n=e[t(160)][t(164)];if("1"!=$t)return null;let s=n.getNoChildrensObjects();n.removeAll(),e[t(120)][t(155)](s);let i=new et(t(155));i.object=s,e[t(140)](i)}[Qt(113)](t){const e=Qt,n=this.editor,s=n[e(160)][e(189)];let i=n[e(127)],r=n[e(197)],o=n[e(203)];if(n[e(116)][e(113)](s),n[e(153)]=i[e(125)](),n[e(221)][e(171)](),null!=n[e(153)]){let t=n[e(153)][e(218)];return t!==r?r[e(171)]():t!==o&&o[e(171)](),n[e(153)].mousedownHandler(s),void s.event.preventDefault()}o.hide(),r.hide()}[Qt(180)](t){}[Qt(201)](t){}[Qt(131)](t){const e=Qt,n=this[e(170)],s=n[e(160)][e(189)];n[e(166)].hideGuidLine(),n[e(116)][e(131)](s);let i=n[e(160)],r=n[e(197)],o=n[e(203)],a=n[e(153)];if(null!=a)return s[e(210)]&&!(a instanceof Y)&&n[e(169)](e(114)),a.mouseupHandler(s),s[e(174)][e(128)](),void n.update();if(2===s[e(132)])return;let l=i[e(189)].target;if(null!=l?(l[e(152)]&&(l instanceof h?o[e(196)](l):r.attachTo(l)),n[e(221)][e(177)](l)&&n[e(221)][e(165)](l)):(n[e(221)].clearTarget(),r[e(200)](),o.clearTarget()),null!=n[e(224)][e(181)]){let t=n[e(164)][e(191)](),s=te(n,t),i=s[e(218)];s[e(178)][e(209)]((t=>{const n=e;t[n(139)](i),t[n(207)]()}))}n[e(224)][e(196)](null)}[Qt(137)](t){const e=Qt,n=this.editor,s=n.stage[e(189)];if(2==s[e(133)])return;n[e(226)][e(115)](e(182))&&n[e(160)].setCursor(o[e(158)]),n[e(166)][e(117)](s);let i=n[e(153)];if(null!=i){if(s.isDragStart&&!(i instanceof Y)&&n[e(185)](e(114)),i[e(190)](s),s[e(174)]instanceof MouseEvent&&1==s[e(174)][e(145)])return;return void s[e(174)].preventDefault()}n[e(116)][e(137)](s),n[e(224)][e(171)]();const r=n[e(149)][e(188)];if(n[e(160)].inputSystem[e(161)]&&n[e(226)][e(115)](r)){let t=n[e(164)].getNoChildrensObjects(),s=te(n,t)[e(218)];null!=s&&s[e(152)]&&n[e(224)][e(196)](s)}}[Qt(206)](t){const e=Qt,n=this[e(170)];let s=n.stage;const i=s.handlerLayer;if(s.localView[e(175)](),s[e(134)]("auto"),n[e(226)][e(115)](e(192))&&n[e(221)][e(119)]([]))return;let r=i[e(125)]();if(r!==n[e(167)]&&(null!=n[e(167)]&&n[e(167)][e(136)](t),null!=r&&r.mouseenterHandler(t)),n[e(167)]=r,null!=r)return void r[e(206)](t);let o=s.getCurrentLayer()[e(125)]();null!=o&&(n[e(160)][e(134)](e(126)),o[e(212)]&&n[e(221)][e(177)](o)&&n.anchorBox.setTarget(o))}mouseenterHandler(t){const e=Qt,n=this[e(170)];n[e(203)].mouseenterStageHandler(),n[e(197)][e(124)](),n[e(221)][e(124)]()}[Qt(136)](t){const e=Qt,n=this[e(170)];n.linkCtrlBox[e(222)](),n[e(197)][e(222)](),n.anchorBox[e(222)]()}[Qt(162)](t){const e=Qt,n=this.editor;if(n[e(138)])n.onLinkCreate(t);else{let s=new et(e(214));s[e(154)]=t,n[e(140)](s),s=new et("drawLineStart"),s.object=t,n[e(140)](s)}}onlineDrawingFinishedHandler(t){const e=Qt,n=this[e(170)];let s=new et(e(129));s.object=t,n[e(140)](s),s=new et(e(193)),s[e(154)]=t,n[e(140)](s)}[Qt(130)](t,e){const n=Qt,s=this[n(170)];if(s[n(160)][n(189)][n(143)]&&s[n(185)](n(123)),1==e[n(156)]){const t=e[0],i=s[n(184)]().toStageRect(t[n(205)][n(219)])[n(216)]();s[n(166)][n(117)](i)}}selectedGroupDragEndHandler(t,e){const n=Qt,s=this[n(170)];s[n(160)].inputSystem[n(199)]?(e[n(209)]((t=>{const e=n;t[e(212)]&&(t.x=Math[e(141)](t.x),t.y=Math[e(141)](t.y))})),s.recordEnd("对象拖拽")):s.recordInterrupt()}}const se=re;function ie(){const t=["resizeTo","editor","translateWith","_obb","getBottom","ceil","左对齐","网格布局","getUnionRect","sqrt","移至顶部","update","上移一层","width","10040520BCnQSw","easeInQuart","outerGrid","unionRects","3471VTWkLo","doGridLayout","getCenter","2578596mVevZx","3FHVrzX","selectedGroup","doLayout","map","zIndex","7023123cHSNbE","filter","178QBQwgC","stage","aabb","showOpTooltip","getNoChildrensObjects","shapeLayout","155HYPZls","7408687ORbYWU","setZIndex","isNode","160074TFqoPY","length","底部对齐","8EpsPuP","垂直中心对齐","evenSpacing","getRight","align","右对齐","isAlone","8461061WAvzqD","translate"];return(ie=function(){return t})()}function re(t,e){const n=ie();return(re=function(t,e){return n[t-=272]})(t,e)}!function(t,e){const n=re,s=ie();for(;;)try{if(851278===-parseInt(n(278))/1*(parseInt(n(289))/2)+parseInt(n(282))/3*(parseInt(n(281))/4)+-parseInt(n(295))/5*(-parseInt(n(299))/6)+parseInt(n(309))/7*(-parseInt(n(302))/8)+-parseInt(n(287))/9+parseInt(n(274))/10+parseInt(n(296))/11)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();class oe{constructor(t){this[re(312)]=t}[se(297)](t,e){const n=se;e===n(272)?t[n(286)]++:"下移一层"===e?t.zIndex--:e===n(321)?t[n(286)]=1e3:"移至底部"===e&&(t.zIndex=0),t.parent.updatezIndex()}[se(304)](t){const e=se;let n=this.editor.stage[e(283)][e(293)]();n=n.filter((t=>t[e(298)]||t instanceof h&&t[e(308)]())),n[e(300)]}[se(306)](t){const e=se,n=this[e(312)];let s=n[e(290)][e(283)][e(293)]();if(s=s[e(288)]((t=>t[e(298)]||t instanceof h&&t[e(308)]())),0===s.length)return;let i=s[e(285)]((t=>t[e(314)][e(291)])),r=w[e(277)](i);for(let n=0;n<s[e(300)];n++){let i=s[n],o=i[e(314)][e(291)];t===e(317)?i[e(313)](r.x-o.x,0):t===e(307)?i[e(313)](r[e(305)]()-o[e(305)](),0):"顶部对齐"===t?i[e(313)](0,r.y-o.y):t===e(301)?i.translateWith(0,r[e(315)]()-o[e(315)]()):"水平中心对齐"===t?i[e(313)](0,r[e(280)]().y-o.getCenter().y):t===e(303)&&i[e(313)](r[e(280)]().x-o[e(280)]().x,0)}n[e(322)]()}[se(279)](){const t=se;let n=this.editor,s=n.stage,i=s[t(283)][t(293)]()[t(288)]((t=>t instanceof e));if(i.length<2)return;let r=Math[t(316)](Math[t(320)](i.length)),o=v[t(319)](i)[t(280)](),a=k[t(276)](r,r),l=s.layoutSystem[t(294)](i,a),c=i[0][t(273)]*r;l[t(311)](c,c),l[t(310)](o.x,o.y),l[t(284)]({effect:t(275),duration:300}),n[t(292)](t(318))}}const ae=le;function le(t,e){const n=he();return(le=function(t,e){return n[t-=170]})(t,e)}!function(t,e){const n=le,s=he();for(;;)try{if(962448===parseInt(n(171))/1*(parseInt(n(189))/2)+-parseInt(n(177))/3+-parseInt(n(187))/4+-parseInt(n(202))/5+-parseInt(n(200))/6*(-parseInt(n(201))/7)+parseInt(n(203))/8+-parseInt(n(184))/9*(-parseInt(n(206))/10))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();class ce{constructor(t){this[le(196)]=t}delete(t){const e=le;let n=this.editor;n[e(173)]("删除"),t.forEach((function(t){const n=e;b.disconnect(t),t[n(183)]()})),n[e(197)]("删除"),n[e(209)]("删除")}[ae(207)](t){const e=ae,n=this.editor;this.editor[e(172)][e(195)].getObject()[e(176)](t);let s=new et("create");s[e(198)]=t,n[e(185)](s)}[ae(170)](t){const e=ae;let n=this.editor[e(172)][e(195)][e(181)](),s=n.x,i=n.y,r=L(t);if(-1!==t[e(194)]("Node")){let t=new r(null,s,i,64,64);return this[e(207)](t),t}if(-1!==t[e(194)](e(204))){let n=new r(null,{x:s-40,y:i},{x:s+40,y:i+(t===e(204)?0:80)});return this[e(207)](n),n}throw new Error(e(175)+t)}[ae(180)](t,e,n,s){const i=ae;let r=this[i(196)];const o=new(L(r.LinkClassName))(t,e,n,s),a=Object[i(193)]({},r.newLinkProperties);a.css&&(o[i(186)](a[i(186)]),delete a[i(186)]),Object[i(179)](a)[i(182)]((t=>{const e=i;let n=a[t];typeof n==e(191)?o[t]=n():o[t]=n}));let l=e[i(188)]||e[i(208)]?e[i(192)]:r.currentLayer;return o[i(174)]=c.EditorNewLink,l[i(176)](o),r[i(178)][i(199)](o),o}[ae(190)](t){const e=ae;this[e(196)][e(178)][e(205)](t)}}function he(){const t=["onLineDrawnHandler","231024XKtSWg","112nyAWiG","5234415hmkVMy","1406000hKPBPz","Link","onlineDrawingFinishedHandler","147380uvMHiO","addNewInstance","isLink","recordEnd","create","1tnxxfa","stage","record","zIndex","unknow classname:","addChild","1228191vHRjkU","editorEventManager","keys","lineDrawn","getMouseXY","forEach","removeFromParent","1494FNdcXH","dispatchEvent","css","4268672EgDrZD","isNode","495148IdbWHB","lineDrawingFinished","function","parent","assign","indexOf","localView","editor","showOpTooltip","object"];return(he=function(){return t})()}const ue=pe;function de(){const t=["10zOKBms","37042335KKiwpr","bottom","align","setBegin","2981184TCtVSO","init","DiableNodeAlign","disable","left","alignInfo","visible","yType","mousedownHandler","aabb","7606638szsJfm","length","toStageRect","isNode","findAlignRectInfo","4560680dUjajN","1616500VmgHQS","133UZGyjH","isIntersectRect","abs","setEnd","getAlignInfo","isKeydown","keyboard","minDistance","dyLine","right","2QeOsjp","mouseupHandler","css","beginArrow","_obb","middle","stageToLocalXY","show","hide","center","editor","objects","alignLineStyle","stage","label","map","update","getCurrentLayer","MAX_VALUE","yRect","endArrow","581032NvnApl","distance","sort","target","parent","mouseEnabled","rect","xRect","top","5WVkLYu","filter","_disabled","addChild","dxLine","displayList","enable","174444YfKjDz","xType"];return(de=function(){return t})()}function pe(t,e){const n=de();return(pe=function(t,e){return n[t-=397]})(t,e)}!function(t,e){const n=pe,s=de();for(;;)try{if(525739===-parseInt(n(404))/1*(parseInt(n(454))/2)+-parseInt(n(427))/3+-parseInt(n(443))/4*(parseInt(n(413))/5)+-parseInt(n(420))/6*(-parseInt(n(444))/7)+-parseInt(n(442))/8+-parseInt(n(437))/9+-parseInt(n(422))/10*(-parseInt(n(423))/11))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();class fe{constructor(t){const e=pe;this.minDistance=U[e(425)][e(451)],this[e(415)]=!1,this[e(433)]=!1,this[e(464)]=t,this[e(428)](t)}init(t){const e=pe;let n=new h(null,{x:0,y:0},{x:100,y:100});n[e(456)](U[e(425)].alignLineStyle),n.mouseEnabled=!1,this.dxLine=n;let s=new h(null,{x:0,y:0},{x:100,y:100});s[e(456)](U[e(425)][e(466)]),s[e(409)]=!1,this.dyLine=s,n[e(462)](),s[e(462)](),t.handlerLayer[e(416)](n),t.handlerLayer.addChild(s)}[ue(430)](){const t=ue;this._disabled=!0,this[t(417)].hide(),this[t(452)][t(462)]()}[ue(419)](){this[ue(415)]=!1}[ue(448)](t,e){const n=ue,s=this[n(464)][n(467)];let i=t[n(407)];if(s.selectedGroup[n(465)][n(438)]>1)return null;let r=this[n(464)].getCurrentLayer();const o=s[n(400)]()[n(418)][n(414)]((t=>t[n(440)]&&t!==i&&t!==t.parent[n(457)]&&t!==t[n(408)][n(403)]&&t!==t.parent[n(397)]))[n(398)]((t=>r[n(439)](t[n(458)].aabb)));return this.findAlignRectInfo(r[n(439)](i[n(458)][n(436)]),o,e)}[ue(435)](t){}[ue(455)](t){const e=ue;if(this[e(415)])return;let n=!this[e(417)][e(433)]&&!this[e(452)][e(433)];if(this[e(417)].hide(),this[e(452)].hide(),n)return;let s=t.target,i=this.alignInfo;if(s&&s[e(440)]&&null!=i){if(this[e(464)][e(400)](),null!=i[e(421)]){let t=i[e(411)],n=i.xType,r=t[i.xType];r=s[e(408)][e(460)](r,0).x,n===e(431)?s[e(431)]=r:n===e(463)?s.x=r:n===e(453)&&(s[e(453)]=r)}if(null!=i[e(434)]){let t=i[e(402)],n=i[e(434)],r=t[i[e(434)]];r=s[e(408)][e(460)](0,r).y,n===e(412)?s[e(412)]=r:n===e(459)?s.y=r:n===e(424)&&(s[e(424)]=r)}this.editor[e(399)](),this.alignInfo=null}}mousedragHandler(t){const e=ue;if(this._disabled)return;let n=t.target;if(null==n||!n.isNode||(this.dxLine.hide(),this[e(452)][e(462)](),this[e(464)][e(450)][e(449)](K[e(429)])))return;let s=this[e(417)],i=this.dyLine;const r=this.getAlignInfo(t,this[e(451)]);if(this[e(432)]=r,null==r)return;let o=r[e(410)];if(null!=r[e(421)]){let t=r[e(411)],n=t[r[e(421)]],i=(o[e(459)]+t[e(459)])/2,a=Math.abs(o[e(459)]-t[e(459)]);s[e(426)]({x:n,y:i-a/2}),s[e(447)]({x:n,y:i+a/2}),s[e(461)]()}if(null!=r.yType){let t=r[e(402)],n=(o[e(463)]+t[e(463)])/2,s=t[r[e(434)]],a=Math.abs(o.center-t[e(463)]);i[e(426)]({x:n-a/2,y:s}),i.setEnd({x:n+a/2,y:s}),i.show()}}[ue(441)](t,e,n){const s=ue;let r,o,a,l,c,h=Number[s(401)],u=Number[s(401)];e[s(406)](((e,n)=>i.distance(t[s(463)],t[s(459)],n[s(463)],n.middle)-i[s(405)](t.center,t[s(459)],e.center,e[s(459)])));for(let i=0;i<e[s(438)];i++){let d=e[i];d[s(445)](t)||(c=Math.abs(t[s(412)]-d[s(412)]),c<=u&&c<=n&&(o=s(412),u=c,l=d),c=Math.abs(t[s(424)]-d.bottom),c<=u&&c<=n&&(o=s(424),u=c,l=d),c=Math[s(446)](t.middle-d.middle),c<=u&&c<=n&&(o=s(459),u=c,l=d),c=Math[s(446)](t.left-d[s(431)]),c<=h&&c<n&&(r=s(431),h=c,a=d),c=Math[s(446)](t.right-d.right),c<=h&&c<n&&(r="right",h=c,a=d),c=Math[s(446)](t.center-d.center),c<=h&&c<n&&(r=s(463),h=c,a=d))}return{x:h,y:u,rect:t,xRect:a,yRect:l,xType:r,yType:o}}}!function(t,e){const n=ye,s=Ie();for(;;)try{if(683380===-parseInt(n(139))/1*(-parseInt(n(132))/2)+-parseInt(n(140))/3*(-parseInt(n(143))/4)+-parseInt(n(146))/5+parseInt(n(138))/6*(parseInt(n(134))/7)+-parseInt(n(130))/8+-parseInt(n(142))/9+-parseInt(n(135))/10)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();const ge={getItem:function(t){return localStorage.getItem(t)},setItem:function(t,e){localStorage.setItem(t,e)},saveWithVersion(t,e){const n=ye;t+=Date[n(137)](),this[n(136)](t,e)},getAllVersions(t){const e=ye;return Object[e(145)](localStorage).filter((n=>n[e(133)](t))).sort()},getLastVersion(t,e){const n=ye;let s=this[n(144)](t).reverse();if(0===s[n(131)])return;null==e&&(e=0),e+1>=s[n(131)]&&(e=s[n(131)]-1);let i=s[e];return this[n(141)](i)}};function ye(t,e){const n=Ie();return(ye=function(t,e){return n[t-=130]})(t,e)}function Ie(){const t=["11168370ByofiF","12khrkBb","getAllVersions","keys","13555Bvjhim","1956912okpfHZ","length","6NfWkZG","startsWith","6570627RInAzf","6734780CbKYZf","setItem","now","6DvTqyR","180393BEPUNb","1365273pqmZgJ","getItem"];return(Ie=function(){return t})()}const me=be;function be(t,e){const n=we();return(be=function(t,e){return n[t-=458]})(t,e)}function we(){const t=["3226026eOwiwK","76122SNkHTG","attach not Node","center","NodeCtrlBox","resizeTo","show","4xwjjVZ","attachTo","2764013CldkFP","962377lhTQxI","currObject","2802065rrQuia","608uFXtes","365757hFSChy","getStageTransform","updateSize","css","rotate","hide","dropBox","zIndex","isLink","positionToLocalPoint","style","viewClone","editor","editable","translateTo","point","2682954lQhVHQ"];return(we=function(){return t})()}!function(t,e){const n=be,s=we();for(;;)try{if(726226===-parseInt(n(470))/1+parseInt(n(459))/2+parseInt(n(474))/3+parseInt(n(467))/4*(-parseInt(n(472))/5)+parseInt(n(460))/6+-parseInt(n(469))/7+-parseInt(n(473))/8*(-parseInt(n(461))/9))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();class xe extends e{constructor(t,e=0,n=0,s=1,i=1){const r=be;super(null,e,n,e,i),this[r(481)]=c[r(464)],this[r(486)]=t,this[r(477)](U[r(480)][r(484)]),this.mouseEnabled=!1,this[r(479)]()}update(){this.visible&&this.updateSize()}[me(468)](t){const e=me;if(null==t||!0!==t[e(487)])return this[e(471)]=null,void this[e(479)]();if(t[e(482)])throw new Error(e(462));this.currObject=t,this[e(476)](),this[e(466)]()}updateSize(){const t=me;null!=this.currObject&&this.viewClone(this[t(471)])}[me(485)](t){const e=me;let n=t[e(475)](),s=n[e(458)](t[e(483)](a[e(463)])),i=n[e(458)](t[e(483)](a.rm)),r=Math.atan2(i.y-s.y,i.x-s.x);n.rotate(-r);let o=n[e(458)](t[e(483)](a[e(463)])),l=n[e(458)](t[e(483)](a.rb)),c=2*(l.x-o.x),h=2*(l.y-o.y);this[e(465)](c+8,h+8),this[e(478)](r),this[e(488)](s.x,s.y)}}function Ce(){const t=["pasteHandler","顶部对齐","右对齐","evenSpacing","zIndex","setZIndex","806790bGwNBV","200spRxdr","水平中心对齐","addEventListener","stage","移至顶部","底部对齐","30trmPAu","align","updateZIndex","移至底部","垂直中心对齐","4833010WvvYqO","2435615zGsHLJ","9221zjgNSJ","左右等距","下移一层","上下等距","860332oFgyXx","36iqzBCz","update","1904472CRGYXz","1880rUKEsm","item","parent","deleteHandler","左对齐","target","上移一层",'\n<div class="header">编辑</div>\n<a>剪切</a>\n<a>复制</a>\n<a>粘贴</a>\n<a>删除</a>\n<hr>\n<div class="header">前后</div>\n<a>上移一层</a>\n<a>下移一层</a>\n<a>移至顶部</a>\n<a>移至底部</a>\n<div class="header">对齐</div>\n<a>左对齐</a>\n<a>右对齐</a>\n<a>顶部对齐</a>\n<a>底部对齐</a>\n<a>水平中心对齐</a>\n<a>垂直中心对齐</a>\n',"copyHandler","layoutManager"];return(Ce=function(){return t})()}const Se=ke;!function(t,e){const n=ke,s=Ce();for(;;)try{if(476963===parseInt(n(282))/1*(parseInt(n(269))/2)+-parseInt(n(289))/3+parseInt(n(286))/4+parseInt(n(268))/5*(parseInt(n(275))/6)+-parseInt(n(281))/7+parseInt(n(290))/8*(-parseInt(n(287))/9)+-parseInt(n(280))/10)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();let ve=Se(297);function ke(t,e){const n=Ce();return(ke=function(t,e){return n[t-=262]})(t,e)}const Le=He;function He(t,e){const n=Pe();return(He=function(t,e){return n[t-=117]})(t,e)}function Pe(){const t=["getCurrentLayer","keyboard","setItem","mousedragHandler","mouseupHandler","newLinkProperties","lastLayerState","mousemoveHandler","cancel","3tnPIgb","handlerLayer","style","99Hgvtsj","localLastDocName","width","assign","instanceManager","mousewheelHandler","dispatchEvent","black","4099160SCusQi","camera","create","opTooltip","restoreToJson","1425968MiAVtL","toFileJson","mousedownHandler","1046380RKgBoV","enable","4305665jedRtZ","686712SPDudo","target","fadeOut","linkCtrlBox","KeysConfig","mouseOverTarget","height","mouseenterHandler","redoUndoSys","saveHandler","clearTarget","getItem","nodeCtrlBox","DataCenter","clearCtrlBoxs","openLasted","500412HnDSAt","selectedGroupDragEndHandler","4ZIxDxu","anchorBox","guidlineManager","popupMenu","selectedGroupDragHandler","imageToBase64","inputSystem","openJson","warn","object","lineDrawn","mouseoutHandler","open","sendKey","20px","serializerSystem","data","editor","editorEventManager","record","stage","update","msg","keyManager","LinkClassName","recordInterrupt","save","currentLayer","domElement","showAt","setLinkClassName","dblclickHandler","alignManager","targetOnly","723777sXrhOy","newLink","recordName","clipboardManager","dropToBox","getState","selectedGroup","AutoFoldLink"];return(Pe=function(){return t})()}!function(t,e){const n=He,s=Pe();for(;;)try{if(482360===parseInt(n(148))/1+-parseInt(n(203))/2*(parseInt(n(165))/3)+-parseInt(n(205))/4*(parseInt(n(176))/5)+parseInt(n(187))/6+-parseInt(n(186))/7+parseInt(n(181))/8+-parseInt(n(168))/9*(-parseInt(n(184))/10))break;s.push(s.shift())}catch(t){s.push(s.shift())}}();class Ee extends t{constructor(t){const e=He;super(),this[e(191)]=K,this.EditorConfig=U,this[e(138)]=e(155),this[e(161)]={},this.DataCenter=ge,this[e(119)]=!1,this.stage=t,t[e(131)]=this,this[e(141)]=this.getCurrentLayer(),this[e(166)]=t[e(166)],this[e(154)]=this[e(134)].selectedGroup,this[e(157)]=t[e(157)],this[e(151)]=new qt(this),this.instanceManager=new ce(this),this[e(132)]=new ne(this),this[e(137)]=new At(this),this[e(199)]=new ft(this),this.linkCtrlBox=new St(this),this[e(206)]=new Lt(this),this[e(152)]=new xe(this),this[e(117)]=function(t){const e=Se,n=t[e(272)];let s=new H(n,ve);return s[e(271)]("select",(function(s){const i=e,r=s[i(291)];let o=n.inputSystem[i(295)];"剪切"===r?t.clipboardManager.cutHandler():"复制"===r?t.clipboardManager[i(298)]():"粘贴"===r?t.clipboardManager[i(262)]():"删除"===r&&t.editorEventManager[i(293)](),null!=o&&(r===i(296)||r===i(284)?t.layoutManager[i(267)](o,r):r===i(273)?t[i(299)][i(267)](o,r):r===i(278)?t[i(299)].setZIndex(o,r):"左对齐"===r?t[i(299)][i(276)](i(294)):r===i(264)?t[i(299)][i(276)](i(264)):r===i(263)?t[i(299)][i(276)]("顶部对齐"):r===i(274)?t[i(299)][i(276)](i(274)):r===i(270)?t[i(299)][i(276)](i(270)):r===i(279)?t.layoutManager.align(i(279)):r===i(283)?t.layoutManager[i(265)](i(283)):r===i(285)&&t.layoutManager[i(265)](i(285)),o[i(266)]<0?o[i(266)]=0:o[i(266)]>1e3&&(o[i(266)]=1e3),null!=o[i(292)]&&o[i(292)][i(277)](),t[i(288)]())})),s}(this),this[e(134)][e(120)][e(188)]=null,this.controlTarget=null,this[e(192)]=null,this.inputTextfield=new P(this),this.redoUndoSys=new Mt(this),this.layoutManager=new oe(this),this[e(207)]=new Ft(this),this[e(146)]=new fe(this),this[e(179)]=new E(t),Object[e(171)](this[e(179)][e(142)][e(167)],{paddingLeft:e(128),paddingRight:"20px",color:e(175)})}[Le(144)](t){this[Le(138)]=t}[Le(156)](){const t=Le;return this[t(134)][t(156)]()}defineKeys(t){const e=Le;Object[e(171)](this[e(191)],t)}showOpTooltip(t){const e=Le;U.operationTip[e(185)]&&(this[e(179)].setHtml(t),this[e(179)][e(143)](.5*this[e(134)][e(170)],.5*this[e(134)][e(193)]),this[e(179)][e(189)](80))}[Le(196)](t,e=!1){const n=Le;let s=this.getCurrentLayer()[n(182)]({imageToBase64:e});this[n(200)][n(158)](U[n(130)][n(169)],s);const i=new et(n(140));i.object=s,i[n(119)]=e,this[n(174)](i)}[Le(202)](){const t=Le,e=this[t(156)](),n=this[t(200)][t(198)](U[t(130)][t(169)]);return null!=n?e[t(121)](n):null}[Le(145)](t){const e=Le;this[e(132)].dblclickHandler(t),this[e(135)]()}[Le(173)](t){const e=Le;this[e(132)][e(173)](t),this.update()}[Le(183)](t){const e=Le;this[e(132)][e(183)](t),this.update()}mouseupHandler(t){const e=Le;this[e(132)][e(160)](t),this[e(135)]()}mousedragHandler(t){const e=Le;this[e(132)][e(159)](t),this[e(135)]()}mousemoveHandler(t){const e=Le;if(this.stage[e(120)].isDragging)return this[e(159)](t);this.editorEventManager[e(163)](t),this[e(135)]()}[Le(194)](t){const e=Le;this[e(132)][e(194)](t),this[e(135)]()}[Le(125)](t){const e=Le;this.editorEventManager[e(125)](t),this[e(135)]()}[Le(118)](t,e){const n=Le;this[n(132)][n(118)](t,e)}[Le(204)](t,e){const n=Le;this.editorEventManager[n(204)](t,e)}[Le(139)](){const t=Le;this.recordName=null,this[t(162)]=null}[Le(133)](t){const e=Le;let n=this[e(141)][e(134)][e(129)];null!=this.recordName&&console[e(122)]("record和recordEnd没有成对出现",this[e(150)]+":"+t),this.recordName=t,this[e(162)]=n[e(153)](this[e(141)])}recordEnd(t){const e=Le;this.recordName,this[e(150)]=null;let n=this.currentLayer,s=n[e(134)][e(129)],i=this[e(162)],r=s[e(153)](n);this[e(195)].push(t,(function(){s[e(180)](n,r)}),(function(){s.restoreToJson(n,i)}))}[Le(149)](t,e,n,s){const i=Le;return this[i(172)][i(124)](t,e,n,s)}[Le(135)](){const t=Le;this[t(152)][t(135)](),this[t(199)].update(),this[t(206)][t(135)](),this[t(134)].update()}toJson(t=!1){const e=Le;return this[e(156)]()[e(182)](t)}[Le(121)](t){const e=Le;this[e(156)]()[e(121)](t);let n=new et(e(126));n[e(123)]=t,this[e(174)](n)}showTip(t,e=""){const n=Le;let s=new Event("log");s[n(136)]=t+e,this[n(174)](s)}create(t){const e=Le;return this.instanceManager[e(178)](t)}[Le(201)](){const t=Le;this[t(206)][t(197)](),this.nodeCtrlBox[t(197)](),this[t(190)].clearTarget()}toogleLocalView(){const t=Le;let e=this[t(134)][t(120)][t(188)];this[t(134)][t(177)][t(147)](e),this[t(201)](),this[t(135)]()}[Le(127)](t,e){const n=Le;this[n(157)][n(127)](t,e)}onEsc(){const t=Le;this[t(206)][t(164)]()}}const Te=je;function De(){const t=["3662712SEhjsS","20dpniBb","65330aqsqFl","shape","Editor","12313urSpjg","pickType","Circle","getOwnPropertyDescriptor","6ATJkfL","length","118872UGypIv","KeysConfig","1992716rFwJuX","4656328rqMmLy","prototype","1856715irgDWs"];return(De=function(){return t})()}function je(t,e){const n=De();return(je=function(t,e){return n[t-=401]})(t,e)}!function(t,e){const n=je,s=De();for(;;)try{if(349912===-parseInt(n(411))/1*(parseInt(n(410))/2)+-parseInt(n(403))/3+parseInt(n(405))/4+parseInt(n(408))/5+parseInt(n(401))/6*(-parseInt(n(414))/7)+parseInt(n(406))/8+-parseInt(n(409))/9)break;s.push(s.shift())}catch(t){s.push(s.shift())}}();let Me=(t,e,n,s)=>{let i;for(let s=t[je(402)]-1;s>=0;s--){let r=t[s];r&&(i=r(e,n,i)||i)}return i&&Object.defineProperty(e,n,i),i};Me([T(k[Te(416)])],Y[Te(407)],Te(412)),Me([T("shape")],Y[Te(407)],Te(415)),Ee[Te(404)]=K,D[Te(413)]=Ee;export{Ee as Editor,M as IconsPanel,G as PropertiesPanel};
